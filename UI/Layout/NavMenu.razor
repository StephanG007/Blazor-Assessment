@using UI.Services
@inject AuthState AuthState
@implements IDisposable

<MudNavMenu Dense="true">
    @if (IsAuthenticated)
    {
        <MudNavLink Href="/bookings" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Event">
            Book appointment
        </MudNavLink>
    }
</MudNavMenu>

@code {
    private bool IsAuthenticated => AuthState.CurrentUser is not null;

    protected override void OnInitialized()
    {
        AuthState.StateChanged += HandleStateChanged;
    }

    private void HandleStateChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        AuthState.StateChanged -= HandleStateChanged;
    }
}
