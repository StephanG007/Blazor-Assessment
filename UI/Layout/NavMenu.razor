@using UI.Services
@inject AuthState AuthState
@implements IDisposable

<MudNavMenu Dense="true">
    <MudNavLink Href="/bookings" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Event">
        Book appointment
    </MudNavLink>
    @if (IsAuthenticated)
    {
        <MudNavLink Href="/users" Icon="@Icons.Material.Filled.Group">
            Users
        </MudNavLink>
    }
</MudNavMenu>

@code {
    private bool IsAuthenticated => AuthState.CurrentUser is not null;

    protected override void OnInitialized()
    {
        AuthState.StateChanged += HandleStateChanged;
    }

    private void HandleStateChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        AuthState.StateChanged -= HandleStateChanged;
    }
}
