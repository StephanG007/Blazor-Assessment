@namespace UI.Components.Bookings

<MudCard Class="@CardClass" Elevation="@(Selected ? 10 : 3)" @onclick="HandleClick">
    <MudCardContent Class="clinic-card__content">
        <MudStack Class="clinic-card__stack">
            <MudStack Row="true" AlignItems="AlignItems.Center" Class="clinic-card__header">
                @if (!string.IsNullOrWhiteSpace(Clinic.LogoDataUrl))
                {
                    <MudAvatar Size="Size.Medium" Class="clinic-card__badge">
                        @if (!string.IsNullOrWhiteSpace(Clinic.LogoDataUrl))
                        {
                            <MudImage Src="@Clinic.LogoDataUrl"
                                      Alt="@($"{Clinic.Name} logo")"
                                      Width="40" Height="40"
                                      Class="object-contain" />
                        }
                        else
                        {
                            <MudIcon Icon="@Icons.Material.Filled.HealthAndSafety" />
                        }
                    </MudAvatar>
                }
                else
                {
                    <MudAvatar Size="Size.Medium"
                               Color="Color.Primary"
                               Variant="Variant.Filled"
                               Class="clinic-card__logo">
                        <MudIcon Icon="@Icons.Material.Filled.HealthAndSafety" />
                    </MudAvatar>
                }
                <MudText Typo="Typo.h6" Class="clinic-card__title">@Clinic.Name</MudText>
            </MudStack>

            <MudStack Row="true" AlignItems="AlignItems.Center" Class="clinic-card__location">
                <MudIcon Icon="@Icons.Material.Filled.Place" Size="Size.Small" style="margin-right:6px;" />
                <MudText Typo="Typo.subtitle2">@Clinic.DisplayLocation</MudText>
            </MudStack>

            @if (!string.IsNullOrWhiteSpace(Clinic.PhoneNumber))
            {
                <MudStack Row="true" AlignItems="AlignItems.Center" Class="clinic-card__contact">
                    <MudIcon Icon="@Icons.Material.Filled.Phone" Size="Size.Small" style="margin-right:6px;" />
                    <MudText Typo="Typo.body2">@Clinic.PhoneNumber</MudText>
                </MudStack>
            }

            <MudChip T="string"
                     Color="Color.Secondary"
                     Variant="Variant.Outlined"
                     Class="slot-summary">
                <MudIcon Icon="@Icons.Material.Filled.Schedule" Size="Size.Small" style="margin-right:6px;" />
                @Clinic.SlotSummary
            </MudChip>
        </MudStack>
    </MudCardContent>
</MudCard>

@code {
    [Parameter, EditorRequired]
    public ClinicSummary Clinic { get; set; } = default!;

    [Parameter]
    public bool Selected { get; set; }

    [Parameter]
    public EventCallback<ClinicSummary> OnSelected { get; set; }

    [Parameter]
    public string? AccentClass { get; set; }

    private string CardClass
    {
        get
        {
            var classes = new List<string> { "clinic-card" };

            if (Selected)
            {
                classes.Add("clinic-card--selected");
            }

            if (!string.IsNullOrWhiteSpace(AccentClass))
            {
                classes.Add(AccentClass);
            }

            return string.Join(" ", classes);
        }
    }

    private Task HandleClick() => OnSelected.InvokeAsync(Clinic);
}